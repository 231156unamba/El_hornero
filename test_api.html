<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de APIs</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .test-box { background: white; padding: 20px; margin: 10px 0; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        button { background: #ff6f00; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #ff8a40; }
        pre { background: #f9f9f9; padding: 10px; border-radius: 5px; overflow-x: auto; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Test de APIs El Hornero</h1>

    <div class="test-box">
        <h3>Test 1: Cargar MenÃº (menu_api.php)</h3>
        <button onclick="testMenu()">Probar menu_api.php</button>
        <div id="menuResult"></div>
    </div>

    <div class="test-box">
        <h3>Test 2: Crear Pedido (pedido_api.php)</h3>
        <button onclick="testCreateOrder()">Crear Pedido de Prueba</button>
        <div id="createResult"></div>
    </div>

    <div class="test-box">
        <h3>Test 3: Listar Pedidos (pedido_api.php)</h3>
        <button onclick="testListOrders()">Listar Todos los Pedidos</button>
        <div id="listResult"></div>
    </div>

    <script>
        async function testMenu() {
            const el = document.getElementById('menuResult');
            el.innerHTML = '<p>Cargando...</p>';
            try {
                const res = await fetch('./resources/js/menu_api.php');
                const data = await res.json();
                el.innerHTML = `
                    <p class="success">âœ“ Ã‰xito (Status: ${res.status})</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch(err) {
                el.innerHTML = `<p class="error">âœ— Error: ${err.message}</p>`;
            }
        }

        async function testCreateOrder() {
            const el = document.getElementById('createResult');
            el.innerHTML = '<p>Creando pedido...</p>';
            try {
                const formData = new URLSearchParams();
                formData.append('mesa', '5');
                formData.append('detalle', 'Pizza grande x2, Lomo saltado x1');
                
                const res = await fetch('./resources/js/pedido_api.php', {
                    method: 'POST',
                    body: formData,
                    credentials: 'include'
                });
                const data = await res.json();
                el.innerHTML = `
                    <p class="success">âœ“ Ã‰xito (Status: ${res.status})</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch(err) {
                el.innerHTML = `<p class="error">âœ— Error: ${err.message}</p>`;
            }
        }

        async function testListOrders() {
            const el = document.getElementById('listResult');
            el.innerHTML = '<p>Cargando pedidos...</p>';
            try {
                const res = await fetch('./resources/js/pedido_api.php');
                const data = await res.json();
                el.innerHTML = `
                    <p class="success">âœ“ Ã‰xito (Status: ${res.status})</p>
                    <p>Total de pedidos: ${data.length}</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch(err) {
                el.innerHTML = `<p class="error">âœ— Error: ${err.message}</p>`;
            }
        }
    </script>
</body>
</html>
