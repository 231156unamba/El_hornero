<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Test Menu API</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .box { background: white; padding: 20px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        button { background: #ff6f00; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 10px 0; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; border-radius: 5px; }
        .error { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
    </style>
</head>
<body>
    <div class="box">
        <h1>üîç Test de menu_api.php</h1>
        <button onclick="testAPI()">Probar API</button>
        <div id="resultado"></div>
    </div>

    <script>
        async function testAPI() {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML = '<p>Cargando...</p>';
            
            try {
                console.log('Intentando fetch a: ./resources/js/menu_api.php');
                const res = await fetch('./resources/js/menu_api.php');
                
                console.log('Response status:', res.status);
                console.log('Response headers:', res.headers);
                
                const text = await res.text();
                console.log('Response text:', text);
                
                let data;
                try {
                    data = JSON.parse(text);
                } catch(e) {
                    resultado.innerHTML = `
                        <p class="error">‚ùå Error al parsear JSON</p>
                        <p>Response recibido:</p>
                        <pre>${text}</pre>
                    `;
                    return;
                }
                
                if (res.ok && Array.isArray(data)) {
                    resultado.innerHTML = `
                        <p class="success">‚úÖ API funcionando correctamente</p>
                        <p><strong>Total de platos:</strong> ${data.length}</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                } else if (data.error) {
                    resultado.innerHTML = `
                        <p class="error">‚ùå Error en la API: ${data.error}</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                } else {
                    resultado.innerHTML = `
                        <p class="error">‚ùå Respuesta inesperada</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                }
            } catch(err) {
                resultado.innerHTML = `
                    <p class="error">‚ùå Error de conexi√≥n: ${err.message}</p>
                    <p>Aseg√∫rate que:</p>
                    <ul>
                        <li>El servidor PHP est√° corriendo: php -S localhost:8000</li>
                        <li>La BD est√° creada y tiene datos</li>
                        <li>conexion.php est√° bien configurado</li>
                    </ul>
                `;
            }
        }
    </script>
</body>
</html>
